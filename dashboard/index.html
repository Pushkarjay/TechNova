<!DOCTYPE html>
<html>
<head>
  <title>Flagged Billboards Dashboard</title>
  <script src="src/config.js"></script>
  <script>
    (function() {
      // Dynamically load Firebase and Maps using values from src/config.js (gitignored)
      function initFirebaseAndMaps() {
        if (!window.APP_CONFIG) {
          console.error('APP_CONFIG not found. Create dashboard/src/config.js from config.example.js');
          return;
        }
        // Initialize Firebase using provided config object
        if (typeof firebase !== 'undefined' && window.APP_CONFIG.FIREBASE_CONFIG) {
          firebase.initializeApp(window.APP_CONFIG.FIREBASE_CONFIG);
        }
        // Load Firestore after firebase is ready (if not already loaded)
        // Load Google Maps dynamically with the provided API key
        var mapsKey = window.APP_CONFIG.GOOGLE_MAPS_API_KEY;
        if (!mapsKey) {
          console.error('GOOGLE_MAPS_API_KEY missing from APP_CONFIG');
          return;
        }
        var script = document.createElement('script');
        script.src = 'https://maps.googleapis.com/maps/api/js?key=' + encodeURIComponent(mapsKey) + '&callback=initMap';
        script.async = true;
        script.defer = true;
        document.head.appendChild(script);
      }

      // Load Firebase SDKs first, then initialize everything
      if (typeof firebase === 'undefined') {
        var fb = document.createElement('script');
        fb.src = 'https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js';
        fb.onload = function() {
          var fb2 = document.createElement('script');
          fb2.src = 'https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js';
          fb2.onload = initFirebaseAndMaps;
          document.head.appendChild(fb2);
        };
        document.head.appendChild(fb);
      } else {
        initFirebaseAndMaps();
      }
    })();
  </script>
  <script src="src/main.js"></script>
</head>
<body>
  <div id="map" style="height: 100vh; width: 100%;"></div>
</body>
</html>
